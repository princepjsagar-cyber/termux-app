name: Keepalive Pinger

on:
  schedule:
    - cron: "*/5 * * * *"
  workflow_dispatch:

jobs:
  ping:
    runs-on: ubuntu-latest
    steps:
      - name: Ping health endpoints
        shell: bash
        env:
          URLS: ${{ secrets.KEEPALIVE_URLS }}
        run: |
          set -e
          if [ -z "${URLS}" ]; then
            echo "No KEEPALIVE_URLS secret set."
            exit 0
          fi
          for u in ${URLS}; do
            echo "Pinging ${u}"
            curl -fsS --max-time 10 "$u" || echo "Failed: $u"
          done